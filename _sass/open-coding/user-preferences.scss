:root {
  // Default fallback values - these are only used when JS sets the vars
  --pref-bg-color: #0b1220;
  --pref-text-color: #e6eef8;
  --pref-font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  --pref-font-size: 14px;
  --pref-content-max-width: 1200px;
}

// When the theme is active, aggressively restyle key containers and text.
// All overrides are scoped to .user-theme-active so "Restore original styling" works.

.user-theme-active {
  // Root and major shells - apply base preferences
  &, &.dark {
    background-color: var(--pref-bg-color) !important;
    color: var(--pref-text-color) !important;
    font-family: var(--pref-font-family) !important;
    font-size: var(--pref-font-size) !important;
  }

  body, body.dark, body.min-h-screen, body.bg-neutral-800 {
    background-color: var(--pref-bg-color) !important;
    color: var(--pref-text-color) !important;
    font-family: var(--pref-font-family) !important;
    font-size: var(--pref-font-size) !important;
  }

  & .min-h-screen, & .min-h-screen.bg-neutral-900,
  & .ml-64.p-8, & .ml-64.p-8.bg-neutral-900 {
    color: var(--text) !important;
    background-color: var(--background) !important;
  }

  // Make sure all normal text inherits theme colors.
  * {
    color: var(--text) !important;
  }

  // OpenCS content areas
  .opencs_root,
  .opencs_root *,
  .opencs_root .post-header,
  .opencs_root .post-content {
    color: var(--text) !important;
    font-family: var(--pref-font-family) !important;
    font-size: var(--pref-font-size) !important;
  }

  // Minima + generic content wrappers
  .page-content,
  .wrapper,
  main,
  article,
  .post,
  .content,
  .opencs_root {
    --background: var(--pref-bg-color) !important;
    --text: var(--pref-text-color) !important;
    background-color: var(--background) !important;
  }

  .card,
  .panel,
  .box,
  .bg-neutral-800,
  .bg-neutral-900,
  .bg-slate-800,
  .bg-slate-900,
  .bg-gray-900,
  .bg-gray-950,
  .bg-zinc-900,
  .bg-slate-950 {
    background-color: var(--panel) !important;
    border-color: var(--ui-border) !important;
  }

  .border-neutral-700,
  .border-neutral-800,
  .border-gray-800,
  .border-gray-900,
  .border-zinc-800 {
    border-color: var(--ui-border) !important;
  }

  img,
  video,
  svg,
  iframe {
    background-color: transparent !important;
  }

  input,
  select,
  textarea {
    background-color: var(--ui-bg) !important;
    color: var(--text) !important;
    border: 1px solid var(--ui-border) !important;
  }

  button {
    background-color: var(--ui-bg) !important;
    color: var(--text) !important;
    border: 1px solid var(--ui-border) !important;
  }

  aside,
  .sidebar,
  #sidebar,
  .site-sidebar,
  .sidebar-container {
    background-color: var(--panel-mid) !important;
    color: var(--text) !important;
    border-color: var(--ui-border) !important;
  }

  // Constrain main content wrapper when preferences are active
  .w-full {
    max-width: var(--pref-content-max-width);
    margin: 0 auto;
  }
}
